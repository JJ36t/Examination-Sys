import os

# إعدادات أساسية للخادم
bind = f"0.0.0.0:{os.environ.get('PORT', '8000')}"
workers = 1  # استخدام عامل واحد فقط لتجنب استهلاك الذاكرة الزائد
threads = 4  # استخدام 4 مؤشرات ترابط لكل عامل
worker_class = 'gthread'  # استخدام worker class أكثر كفاءة

# إعدادات المهلة
timeout = 120  # مهلة معقولة (2 دقائق) لمنع تعليق العمليات
keepalive = 5  # الحفاظ على الاتصالات مفتوحة لمدة 5 ثوانٍ

# إعدادات الطلبات
max_requests = 250  # تقليل عدد الطلبات قبل إعادة تشغيل العامل
max_requests_jitter = 30  # تباين عشوائي لمنع إعادة تشغيل جميع العمال في نفس الوقت

# إعدادات لتحسين الأداء
worker_tmp_dir = '/tmp'  # استخدام مجلد مؤقت للبيانات المؤقتة
preload_app = False  # تعطيل التحميل المسبق لتجنب مشاكل الذاكرة
reload = False  # تعطيل إعادة التحميل التلقائي في بيئة الإنتاج

# إعدادات السجلات
accesslog = '-'  # إرسال سجلات الوصول إلى stdout
errorlog = '-'  # إرسال سجلات الأخطاء إلى stderr
loglevel = 'info'  # مستوى سجل أقل تفصيلاً لتقليل حجم السجلات

# متغيرات البيئة
raw_env = [
    "RENDER=true",
    "PYTHONUNBUFFERED=1",  # منع تخزين مؤقت لمخرجات بايثون
]
